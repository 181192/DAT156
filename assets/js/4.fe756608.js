(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{180:function(e,t,r){e.exports=r.p+"assets/img/deployment-pipeline.904329d6.png"},181:function(e,t,r){e.exports=r.p+"assets/img/flux-helm-gitops.10f51dbe.png"},182:function(e,t,r){e.exports=r.p+"assets/img/high-level-overview.89d9975d.png"},189:function(e,t,r){"use strict";r.r(t);var s=[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"uke-6-the-mad-girlfriend-bug-and-gitops"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uke-6-the-mad-girlfriend-bug-and-gitops","aria-hidden":"true"}},[this._v("#")]),this._v(" Uke 6 - The mad girlfriend bug and GitOps")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("Timer")]),this._v(" "),t("p",[this._v("Denne uken: 42")]),this._v(" "),t("p",[t("strong",[this._v("Totalt: 219")]),this._v(" 游꿀")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#fredag"}},[this._v("Fredag")])]),t("li",[t("a",{attrs:{href:"#torsdag"}},[this._v("Torsdag")]),t("ul",[t("li",[t("a",{attrs:{href:"#weaveworks-flux"}},[this._v("Weaveworks Flux")])]),t("li",[t("a",{attrs:{href:"#jetstack-cert-manager"}},[this._v("Jetstack Cert-Manager")])])])]),t("li",[t("a",{attrs:{href:"#mandag-tirsdag-og-onsdag"}},[this._v("Mandag, tirsdag og onsdag")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"fredag"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fredag","aria-hidden":"true"}},[this._v("#")]),this._v(" Fredag")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("I dag har jeg jobbet med 친 ta neste modul opp i Kubernetes, modulen kalles "),t("em",[this._v("dd_server_domain")]),this._v(" og holder en oversikt over ulike domener som tilh칮rer forskjellige banker. Denne modulen krever en database tilgang.")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("Jeg startet med 친 sette opp en "),r("code",[e._v("Dockerfile")]),e._v(" for 친 pakke modulen inn i en tomcat kontainer. Dette er samme kontaineren som jeg lagde til "),r("em",[e._v("dd_server_location")]),e._v(". Deretter fikk jeg den kontaineren til 친 koble seg til en database som jeg kj칮rte med "),r("code",[e._v("docker-compose")]),e._v(". Da var jeg sikker p친 at applikasjonen fungerte som den skulle, og det eneste som n친 m친tte endres n친r den kom oppi Kubernetes klusteret var milj칮variablene for "),r("code",[e._v("jdbc-url")]),e._v(", passord og brukernavn.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("En "),t("code",[this._v("jdbc-url")]),this._v(" mot en MySQL database ser typisk slik ut,")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("jdbc:mysql://azure-database:3306/test?useSSL=true&requireSSL=false\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Det viste seg til slutt, etter "),t("em",[this._v("mye")]),this._v(" googling, at database connectoren til MySQL har en bug i versjon 5.1.19 som vi brukte, med 친 koble seg til databaser med SSL. Jeg oppgraderte til en nyere versjon 5.1.31 hvor dette er fikset, og vipps s친 fungerte det.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"torsdag"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#torsdag","aria-hidden":"true"}},[this._v("#")]),this._v(" Torsdag")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("I dag startet jeg endelig 친 jobbe med "),t("em",[this._v("Veien til Skyen")]),this._v(" prosjektet igjen. Konsulenten som har v칝rt med meg tidligere kom i dag. I mens prosjektet har st친tt litt stille har jeg lest en del p친 fritiden om forskjellige teknologier og verkt칮y som h칮rer hjemme i sky verdenen. Da kom jeg over ett konsept kalt GitOps, som stammer fra ordet DevOps.")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tip custom-block"},[r("p",{staticClass:"custom-block-title"},[e._v("GitOps")]),e._v(" "),r("p",[e._v("GitOps er en m친te 친 gj칮re kontinuerlig leveranse (CD). Det funger ved 친 bruke Git som sannhet for deklarativ infrastruktur og applikasjoner. Deklarativ programmering betyr 친 skrive kode for 친 beskrive "),r("strong",[e._v("hva programmet skal gj칮re")]),e._v(" i motsetning til "),r("strong",[e._v("hvordan det skal gj칮re det")]),e._v(".")]),e._v(" "),r("p",[e._v("For eksempel: "),r("em",[e._v("det er 10 nginx-servere")]),e._v(", istedet for "),r("em",[e._v("start 10 nginx-servere, og fortell meg om det fungerte eller ikke")]),e._v(".")]),e._v(" "),r("p",[e._v("Men ideen g친r videre - ved hjelp av verkt칮y for 친 se p친 den faktiske tilstanden til produksjonen. Og dersom tilstanden i den virkelige verdenen ikke stemmer med kildekoden, vil du bli varslet slik at du f친r muligheten til 친 se forskjellene og fikse problemet.")]),e._v(" "),r("p",[e._v("Med andre ord GitOps utvider pipelinen med en feedback loop for observering og kontrollering av systemet.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"weaveworks-flux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weaveworks-flux","aria-hidden":"true"}},[this._v("#")]),this._v(" Weaveworks Flux")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("N친r en vanlig utvikler pusher kode til ett repo, s친 vil v친r CI Pipeline i Bitbucket bygge og deploye docker imaget til Azure Container Registry. Da vil Flux laste ned docker imaget og utf칮re endringene mot klusteret, og oppdatere konfigurasjons repo'et.\n"),t("img",{attrs:{src:r(180),alt:"deployment-pipeline"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Vi bruker i tillegg Helm for 친 kunne dra nytte av templates, package managment, test av distribusjoner og rollbacks osv. Da ser oversikten slik ut:\n"),t("img",{attrs:{src:r(181),alt:"flux-helm-gitops"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Dette fikk jeg testet og implementert i dag p친 "),t("em",[this._v("server_location")]),this._v(" modulen. Og det ser ut som dette kan v칝re en utrolig god m친te til 친 holde klusteret i sjakk. Bruker vi GitOps riktig vil det ikke v칝re n칮dvendig 친 aksessere klusteret manuelt for 친 gj칮re endringer. Dette minsker risikoen med at noen klusser til noe. Og at vi alltid har en plass som er sannheten og det er i repo'et.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"jetstack-cert-manager"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jetstack-cert-manager","aria-hidden":"true"}},[this._v("#")]),this._v(" Jetstack Cert-Manager")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:r(182),alt:"high-level-overview"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Dette fikk jeg ogs친 konfigurert opp i dag og lagt inn i Helm Chartet til "),t("em",[this._v("dd_server_location")]),this._v(" modulen.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"mandag-tirsdag-og-onsdag"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mandag-tirsdag-og-onsdag","aria-hidden":"true"}},[this._v("#")]),this._v(" Mandag, tirsdag og onsdag")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"warning custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("Mad girlfriend bug")]),this._v(" "),t("p",[this._v("When you see something strange is happening, but the software is telling you everything is fine.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Har jobbet parallelt med flere oppgaver denne uken. I hovedsak har jeg jobbet med daglige oppgaver fra teamet mitt sin Kanban tavle, siden sky-prosjektet har en liten pause. Vi har nettopp tatt en "),t("em",[this._v("cut fra master")]),this._v(" som blir en leveranse til Eika. Denne har ett par saker som er blitt meldt inn fra kunden selv, og noen saker som testerne v친re har meldt inn. P친 fredag fant jeg noen feil ogs친, som jeg har jobbet med denne uken.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("En sak jeg har sett p친 handlet om renderingen av en komponent i en av klientene som feilet n친r siden ble lastet i en ren nettleser. Med ren nettleser mener jeg at det ikke ligger noe cache som "),t("em",[this._v("localStorage")]),this._v(" og "),t("em",[this._v("sessionStorage")]),this._v(", samt ingen cookies.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Det har v칝rt en frustrerende oppgave, for feilen ligger gjemt i klient koden. Alt p친 server siden var i orden. Til slutt var det flere p친 teamet som s친 p친 problemet. Til slutt viste det seg at kallene som gikk for 친 hente "),t("code",[this._v("i18n")]),this._v(" tekstene som skal vises i klienten feilet, fordi de URL'en de gikk mot ikke var riktige. Dette resulterte i mange andre snodige feil, som gjorde at feilen s친 ut til 친 v칝re noe den slett ikke skulle v칝re.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("I dag (Onsdag) fikk jeg endelig en prat med en av arkitektene som har v칝rt med meg p친 "),t("em",[this._v("Veien mot skyene")]),this._v(" prosjektet, for 친 ta en status p친 hvordan prosjeket ligger an siden jeg skal fortsette med prosjektet fra i morgen av.")])}],n=r(0),i=Object(n.a)({},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),r("p"),e._m(2),r("p"),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),r("p",[e._v("Jeg hadde ogs친 med meg konsulenten i dag. S친 han startet med 친 sette opp Helm chartet, mens jeg klargjorde Docker imaget og konfigurerte Bitbucket Pipeline.")]),e._v(" "),r("p",[e._v("Vi satt opp en "),r("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/mysql/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Database for MySQL"),r("OutboundLink")],1),e._v(" instans i Azure utenfor Klusteret, og lagde en test database som vi kan bruke for test klusteret v친rt.")]),e._v(" "),r("p",[e._v("Men s친 fikk vi latterlig mye problemer med 친 f친 database tilkoblingen til 친 fungere. Azure Database krever SSL som standard.")]),e._v(" "),e._m(6),e._v(" "),e._m(7),r("p",[e._v("og ligger inni Tomcat "),r("code",[e._v("server.xml")]),e._v(" konfigurasjonen under "),r("code",[e._v("<Resource>")]),e._v(" taggen med flere parametre som blandt annet brukernavn, passord og "),r("a",{attrs:{href:"https://github.com/swaldman/c3p0",target:"_blank",rel:"noopener noreferrer"}},[e._v("c3p0"),r("OutboundLink")],1),e._v(" config. c3p0 er ett "),r("em",[e._v("concurrent JDBC Connection pooling library")]),e._v(".")]),e._v(" "),e._m(8),e._v(" "),r("p",[e._v("Siden vi bruker "),r("a",{attrs:{href:"https://www.liquibase.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Liquibase"),r("OutboundLink")],1),e._v(", bygger database skjemaet seg automatisk. Dette gj칮r at vi ikke trenger 친 definere noe skjema, vi trenger bare 친 peke mot databasen s친 ordner applikasjonen resten. Ganske kult!")]),e._v(" "),r("p",[e._v("S친 tweaket vi litt mer med Helm Chartet, ogs친 lot jeg Flux ta over jobben slik at vi kj칮rer etter GitOps prinsippene.")]),e._v(" "),r("p",[e._v("Time antallet for praksisfaget (216 timer) er n친 ogs친 n친dd, s친 mulig dette er siste blogg innlegget.")]),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/weaveworks/flux",target:"_blank",rel:"noopener noreferrer"}},[e._v("Weaveworks Flux"),r("OutboundLink")],1),e._v(" er ett verkt칮y som implementerer GitOps metodikken. Flux blir kj칮rt inni Kubernetes klusteret og synkroniserer seg med konfigurasjons repository som vi hoster p친 Bitbucket. N친r en 칮nsker 친 gj칮re endringer i klusteret pusher utvikleren oppdateringene til repo'et og Flux vil lytte p친 endringer og utf칮re de. Det er lett 친 holde kontroll i git loggen hva Flux har gjort for den tagger, og commiter tilbake til repo'et.")]),e._v(" "),e._m(13),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),r("p",[e._v("N친r vi skal kj칮re tjenestene v친re i skyen hos Azure p친 Kubernetes b칮r vi kryptere trafikken v친r over HTTPS. Da trenger vi ogs친 TLS sertifikater.")]),e._v(" "),r("div",{staticClass:"tip custom-block"},[r("p",{staticClass:"custom-block-title"},[e._v("Cert-Manager")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.cert-manager.io/en/latest/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cert-Manager"),r("OutboundLink")],1),e._v(" er en kraftig, allsidig sertifikatstyringskontroller for Kubernetes. Verkt칮yet vil skaffe sertifikaer, fra en rekke utstedere, og s칮rge for at disse er gyldige og oppdaterte. Og det vil kunne fornye sertifikater p친 en konfigurert tid f칮r de utl칮per.")])]),e._v(" "),r("p",[e._v("Vi kommer til 친 bruke Let's Encrypt som en utsteder. Let's Encrypt er en gratis, automatisert og 친pen sertifikatautoritet fra non-profit organisasjonen Internet Security Research Group (ISRG).")]),e._v(" "),r("p",[e._v("Liten oversikt over hvordan cert-manager virker:")]),e._v(" "),e._m(17),e._v(" "),e._m(18),e._v(" "),r("p",[e._v("Alt i alt en veldig produktiv dag, men gjort mye research og for arbeid. Men etter flere dager med feils칮king i gammel Angular kode, var det g칮y 친 g친 over til dette prosjektet igjen.")]),e._v(" "),r("p",[e._v("I morgen fortsetter arbeidet videre med 친 trekke opp en ny modul i skyen. Denne krever en database tilkobling, s친 her m친 vi finne ut hvor i arkitekturen vi 칮nsker 친 plassere den.")]),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._v(" "),e._m(22),e._v(" "),e._m(23),e._v(" "),r("p",[e._v("Ellers har jeg hjupet en ny student som har begynt 친 jobbe hos oss med 친 sette opp noen API tester i Postman for 친 kj칮re e2e-tester (ende til ende).")]),e._v(" "),r("p",[e._v("Ogs친 har jeg jobbet en del med en pipeline for JWT prosjektet, slik at ting blir bygget opp i Azure Artifacts.")]),e._v(" "),e._m(24)])},s,!1,null,null,null);t.default=i.exports}}]);